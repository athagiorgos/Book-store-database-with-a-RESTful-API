<html>
    <head>
        <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaina+2&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="mystyle.css">
        <div class="welcomeText">
            Welcome to our book registration application
        </div>
         <script type="text/javascript">
            function check() {
                var textfields = document.getElementsByName("textfield");
                for (let i = 0; i < textfields.length; i++) {
                    if(textfields[i].value.length == 0) {
                        alert("Please enter values for the text fields");
                        return false;
                    }
                }
                if(price.value <= 0) {
                    alert("Please enter a valid price");
                    return false;
                }
            }
        </script>
    </head>
    <body>
        <form name="bookform" onsubmit="return check();">
            <div class="row" >
                <div class="col-tags">
                    <label for="author">Author</label>
                </div>
                <div class="col-texts"><input type="text" name="author" id="author" class="textfield" placeholder="Author's name"></div>
            </div>
            <div class="row" >
                <div class="col-tags">
                    <label for="title">Title</label>
                </div>
                <div class="col-texts"><input type="text" name="title" id="title" class="textfield" placeholder="Book's title"></div>
            </div>
            <div class="row" >
                <div class="col-tags">
                    <label for="price">Price</label>
                </div>
                <div class="col-texts"><input type="number" name="price" id="price" class="textfield" placeholder="Price"></div>
            </div>
            <div class="row">
                <div class="col-tags">
                    <label for="genre">Select genre</label>
                </div>
                <div class="col-texts">
                    <select id="genres">
                      <option value="science fiction">Science fiction</option>
                      <option value="satire">Satire</option>
                      <option value="drama">Drama</option>
                      <option value="action and adventure">Action and Adventure</option>
                      <option value="romance">Romance</option>
                      <option value="mystery">Mystery</option>
                      <option value="horror">Horror</option>
                    </select></div>
            </div>
            <div class="row">
                <div class="col-tags">
                    <input type="submit" value="Submit" name="button" id="sub_button">
                </div>
            </div>
            <script>
            document.getElementById('sub_button').addEventListener('click', function(event) {
                const xhr = new XMLHttpRequest();
                xhr.open('POST', 'http://localhost:3000/addBook');
                xhr.setRequestHeader('Content-Type', 'application/json');
                const book = {
                    author: document.getElementById('author').value,
                    title: document.getElementById('title').value,
                    price: document.getElementById('price').value,
                    genre: document.getElementById('genres').value
                };
                xhr.send(JSON.stringify(book));
                xhr.onreadystatechange = function() {
                    if(xhr.readyState == 4 && xhr.status == 200) {
                        alert('OK');
                    }
                }
            });
            </script>
        </form>
    </body>
</html>
